(this.webpackJsonpscrollwave=this.webpackJsonpscrollwave||[]).push([[0],{100:function(e,t,n){},198:function(e,t,n){"use strict";n.r(t);var a,r,o,i,c,l,s=n(0),u=n.n(s),d=n(17),m=n.n(d),f=(n(100),n(3)),v=n(12),p=n.n(v),E=n(24),h=n(18),g=n(8),b=n(19);!function(e){e.ANCHOR="Anchor"}(a||(a={})),function(e){e.PRIMARY="#375a7f",e.PRIMARY_SAT_10="#405a76",e.TURQUOISE="#1abc9c",e.GRAY="#8c9b9d"}(r||(r={})),function(e){e.EDIT="edit",e.VIEW="view"}(o||(o={})),function(e){e.READER_START="Reader Start",e.BLOCK_ENTER="Block Enter",e.SPAN_WILL_ENTER="Span Will Enter",e.SPAN_ENTER="Span Enter",e.BLOCK_WILL_LEAVE="Block Will Leave",e.BLOCK_LEAVE="Block Leave"}(i||(i={})),function(e){e[e.PERIOD=190]="PERIOD"}(c||(c={})),function(e){e.INSERT_ANCHOR="Insert Anchor"}(l||(l={}));var S,y,T=function(e,t,n,r,o){var i=u.a.useState([]),c=Object(f.a)(i,2),l=c[0],s=c[1],d=u.a.useState(0),m=Object(f.a)(d,2),v=m[0],p=m[1],E=function(e){var t=e.getCurrentContent(),n=Object(g.convertToRaw)(t).entityMap;return Object.values(n).filter((function(e){return e.type===a.ANCHOR})).map((function(e){return e.data.id}))};return{placeAnchor:function(o){if(t){p(v+1);var i="".concat(v+1),c=o.getCurrentContent().createEntity(a.ANCHOR,"IMMUTABLE",{id:i}),u=c.getLastCreatedEntityKey(),d=o.getSelection();if(d.getStartOffset()===d.getEndOffset()){var m,f=g.Modifier.insertText(c,d,"\u25a0",void 0,u),E=g.EditorState.push(o,f,"insert-characters");e(E),r(m=i),s([].concat(Object(b.a)(l),[m]))}else n("You can't have anything highlighted when you add an anchor.")}else n("Can't place an anchor yet. Did you upload audio and switch out of automatic mode?")},anchors:l,checkForDeletedAnchors:function(e,t){var n=E(e),a=E(t);if(a.length<n.length){s(a);var r=!0,i=!1,c=void 0;try{for(var l,u=n[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var d=l.value;a.includes(d)||o(d)}}catch(m){i=!0,c=m}finally{try{r||null==u.return||u.return()}finally{if(i)throw c}}}}}},k=u.a.createContext([]),A=new g.CompositeDecorator([{strategy:(S=a.ANCHOR,function(e,t,n){e.findEntityRanges((function(e){var t=e.getEntity();return null!==t&&n.getEntity(t).getType()===S}),t)}),component:function(e){var t=e.contentState.getEntity(e.entityKey).getData().id;u.a.useContext(k).findIndex((function(e){return e===t}));return u.a.createElement("span",{key:t,className:"AnchorSpan"},t)}}]),N=function(e){return e.visible?u.a.createElement("div",{className:"modal is-active"},u.a.createElement("div",{className:"modal-background",onClick:e.onClose}),u.a.createElement("div",{className:"modal-card"},u.a.createElement("header",{className:"modal-card-head"},u.a.createElement("p",{className:"modal-card-title"},e.title),u.a.createElement("button",{className:"delete","aria-label":"close",onClick:e.onClose})),u.a.createElement("section",{className:"modal-card-body"},e.children),u.a.createElement("footer",{className:"modal-card-foot"},e.notifyOnly?u.a.createElement("button",{className:"button",onClick:e.onClose},"Okay"):u.a.createElement(u.a.Fragment,null,u.a.createElement("button",{className:"button is-success",onClick:e.submitDisabled?function(){}:e.onSubmit,disabled:!!e.submitDisabled},"Submit"),u.a.createElement("button",{className:"button",onClick:e.onClose},"Cancel"))))):u.a.createElement("div",null)},O=function(e){return null===e.message?null:u.a.createElement(N,{title:"Error",visible:!0,onClose:e.onClose,notifyOnly:!0},e.message)},R=function(e){return e.keyCode==c.PERIOD&&g.KeyBindingUtil.isCtrlKeyCommand(e)?l.INSERT_ANCHOR:Object(g.getDefaultKeyBinding)(e)},C=u.a.forwardRef((function(e,t){var n=e.canSetAnchors,a=e.onAddAnchor,r=e.onRemoveAnchor,o=u.a.useState(g.EditorState.createWithContent(g.ContentState.createFromText("Start writing your next masterpiece..."),A)),i=Object(f.a)(o,2),c=i[0],s=i[1],d=u.a.useState(null),m=Object(f.a)(d,2),v=m[0],p=m[1],E=T(s,n,p,a,r),h=E.placeAnchor,b=E.anchors,S=E.checkForDeletedAnchors;u.a.useImperativeHandle(t,(function(){return{getContentState:function(){return c.getCurrentContent()}}}));return u.a.createElement(k.Provider,{value:b},u.a.createElement("div",{className:"TextEdit"},u.a.createElement(g.Editor,{editorState:c,onChange:function(e){S(c,e),s(e)},keyBindingFn:R,handleKeyCommand:function(e){return e===l.INSERT_ANCHOR?(h(c),"handled"):"not-handled"}})),u.a.createElement(O,{message:v,onClose:function(){return p(null)}}))})),L=n(91),x=n.n(L),w=n(92),I=n.n(w),j=function(e){return e.isLoading?u.a.createElement("div",{className:"Loadable"},u.a.createElement(h.a,{icon:"spinner",pulse:!0,size:"3x",opacity:.5}),u.a.createElement("div",{style:{display:"none"}},e.children)):u.a.createElement(u.a.Fragment,null,e.children)},P=function(e){return u.a.createElement("div",{className:"AudioControls"},u.a.createElement("button",{className:"BlankButton",onClick:e.onPlayPause},u.a.createElement(h.a,{icon:e.isPlaying?"pause":"play",size:"4x"})))},B=function(e){return u.a.createElement("div",{className:"RegionElementAnnotation"},e.anchorId)},W=u.a.forwardRef((function(e,t){var n=u.a.useState(!1),a=Object(f.a)(n,2),o=a[0],i=a[1],c=u.a.useState(!1),l=Object(f.a)(c,2),d=l[0],v=l[1],p=u.a.useState(100),E=Object(f.a)(p,2),h=(E[0],E[1],u.a.useRef());return Object(s.useEffect)((function(){var t=x.a.create({container:"#AudioEditWaveform",waveColor:r.PRIMARY,progressColor:r.TURQUOISE,cursorColor:r.GRAY,barWidth:3,barRadius:3,cursorWidth:1,height:200,barGap:3,plugins:[I.a.create({})]});t.loadBlob(e.audio),t.on("ready",(function(){i(!0),t.zoom(100)})),t.on("finish",(function(){return v(!1)})),t.on("error",(function(){return e.onError()})),t.on("region-created",(function(e){var t=document.querySelectorAll("[data-id='".concat(e.id,"']"))[0];m.a.render(u.a.createElement(B,{anchorId:e.id}),t)})),h.current=t}),[e.audio]),u.a.useImperativeHandle(t,(function(){return{addAnchor:function(e){if(!h.current)return null;var t=h.current.getCurrentTime();return h.current.addRegion({id:e,drag:!1,resize:!1,start:t,end:t+.03,color:"white"})},removeAnchor:function(e){e.remove()}}})),u.a.createElement("div",null,u.a.createElement("div",{id:"AudioEditWaveform"}),u.a.createElement(j,{isLoading:!o},u.a.createElement(P,{isPlaying:d,onPlayPause:function(){var e;null===(e=h.current)||void 0===e||e.playPause(),v(!d)}})))})),_=n(93),M=n.n(_),D=function(e){switch(e){case i.SPAN_WILL_ENTER:case i.BLOCK_WILL_LEAVE:return 1e3;case i.BLOCK_ENTER:case i.SPAN_ENTER:case i.BLOCK_LEAVE:default:return 0}},K=function(e){return e.split(" ").length},F=[".","?","!",","],G=function(e,t){var n=[t],a=!0,r=!1,o=void 0;try{for(var i,c=function(){var e=i.value,t=[];n.forEach((function(n){t.push.apply(t,Object(b.a)(n.split(e).filter((function(e){return e.trim().length})).map((function(t,n,a){return t+(n<a.length-1?e:"")})))),n.endsWith(e)&&(t[t.length-1]+=e)})),n=t},l=F[Symbol.iterator]();!(a=(i=l.next()).done);a=!0)c()}catch(s){r=!0,o=s}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n.map((function(t,n){return{id:"".concat(e,"_$").concat(n),text:t}}))},U=function(e){var t=u.a.useState(),n=Object(f.a)(t,2),a=n[0],r=n[1];return u.a.createElement(N,{title:"Upload Audio",visible:e.visible,onClose:e.onClose,onSubmit:function(){return a&&e.onSubmit(a)}},u.a.createElement("div",{className:"UploadAudioModalFileInput"},u.a.createElement("div",{className:"file is-boxed"},u.a.createElement("label",{className:"file-label"},u.a.createElement("input",{className:"file-input",type:"file",name:"audio",onChange:function(e){var t=e.target.files[0];t&&r(t)}}),u.a.createElement("span",{className:"file-cta"},u.a.createElement("span",{className:"file-icon"},u.a.createElement(h.a,{icon:"upload"})),u.a.createElement("span",{className:"file-label"},"Choose a file")))),a&&u.a.createElement("div",{className:"UploadAudioModalFileInputData"},a.name,u.a.createElement("br",null),u.a.createElement("strong",null,"Last Modified: "),M()(a.lastModified).format("MMMM Do YYYY, h:mm a"),u.a.createElement("br",null),u.a.createElement("strong",null,"Size: "),function(e){var t=e,n="B";return 0===e||(e>=1e9?(t=e/1e9,n="GB"):e>=1e6?(t=e/1e6,n="MB"):e>=1e3&&(t=e/1e3,n="KB")),"".concat(Number(t.toFixed(2))," ").concat(n)}(a.size))),u.a.createElement("div",{style:{marginTop:12,opacity:.7}},u.a.createElement("i",null,"This file will only be stored in your browser's memory while you use Scrollwave. It will not be sent anywhere by Scrollwave.")))},V=function(e){return u.a.createElement("section",{className:"hero is-fullheight"},e.header&&u.a.createElement("div",{className:"hero-head"},e.header),u.a.createElement("div",{className:"hero-body"},u.a.createElement("div",{className:"container"},e.children)))},H=n(32),Y=n(43);!function(e){e.ReaderData="ReaderData",e.AnimatedReader="AnimatedReader",e.Timeline="Timeline",e.TimelineManager="TimelineManager",e.AnchorBlock="AnchorBlock"}(y||(y={}));var z,J,q,Q,$=[y.ReaderData,y.AnimatedReader,y.Timeline,y.TimelineManager];!function(e){e.AssembleEvents="AssembleEvents",e.GetNextSpanWithStart="GetNextSpanWithStart",e.GetSpanTime="GetSpanTime",e.GetTransitionTimes="GetTransitionTimes",e.FromEditor="FromEditor"}(z||(z={})),function(e){e.HandleRegionEvent="handleRegionEvent"}(J||(J={})),function(e){e.NewTimelineManager="NewTimelineManagerEffect",e.UpdateInterval="UpdateIntervalEffect",e.Tick="TickEffect",e.ValueUpdated="ValueUpdatedEffect"}(q||(q={})),function(e){e.Construct="Construct",e.GetEventsSinceLastTick="GetEventsSinceLastTick",e.InterpolateState="InterpolateState"}(Q||(Q={}));var X=function(e){var t=function(){},n=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(a){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return t.apply(void 0,["".concat(e,"::").concat(a||"enter")].concat(Object(b.a)(n?o.map((function(e){return"object"===typeof e?JSON.parse(JSON.stringify(e)):e})):o)))}},a=$.includes(e);return{log:a?t:n(console.log),logNoCopy:a?t:n(console.log,!1),error:n(console.error)}},Z=X(y.ReaderData),ee=function e(t,n){var a=this;Object(Y.a)(this,e),this.blocks=void 0,this.events=void 0,this.audio=void 0,this.assembleEvents=function(e){Z.log(z.AssembleEvents,"start",{blocks:e});var t=[],n=D(i.SPAN_WILL_ENTER),r=D(i.BLOCK_WILL_LEAVE),o=0,c=0,l=function(e,n,a,r,i){Z.log(z.AssembleEvents,"_pushEvent",{type:e,currentTime:o,duration:n,block:r,span:i}),t.push({id:"".concat(c++),start:o,end:o+n,duration:n,data:{type:e,block:r,span:i},state:a}),o+=n},s=e[0]&&e[0].spans[0],u=s&&s.start||0;l(i.READER_START,u,{},e[0]);var d=a.getNextSpanWithStart(e,0,0,o),m=a.getTransitionTimes(d,n,r);return Z.log(z.AssembleEvents,"before iteration",{currentTime:o,nextSpanWithStart:d}),e.forEach((function(t,c){l(i.BLOCK_ENTER,0,{blockOpacity:{set:1}},t),t.spans.forEach((function(s,u){d.span.id===s.id&&(d=a.getNextSpanWithStart(e,c,u,o),m=a.getTransitionTimes(d,n,r),Z.log(z.AssembleEvents,"resetting tracking span",{block:t,span:s,currentTime:o,nextSpanWithStart:d,transitionTimes:m}));var f=a.getSpanTime(s,d,m.spanEnterLen,m.blockLeaveLen);l(i.SPAN_WILL_ENTER,m.spanEnterLen,{spanOpacity:{from:0,to:1},activeSpan:{set:s}},t,s),l(i.SPAN_ENTER,f,{activeSpan:{set:null},loadedSpans:{set:function(e){return e.concat(s)}}},t,s)})),l(i.BLOCK_WILL_LEAVE,m.blockLeaveLen,{blockOpacity:{from:1,to:0}},t),l(i.BLOCK_LEAVE,0,{loadedSpans:{set:[]}},t)})),t},this.getNextSpanWithStart=function(e,t,n,r){Z.log(z.GetNextSpanWithStart,"start",{blocks:e,blockIdx:t,spanIdx:n,currentTime:r});var o=e.slice(t+1).reduce((function(e,n,a){return e.concat(n.spans.map((function(e){return Object(H.a)({},e,{blockIdx:t+a+1})})))}),[]);o=e[t].spans.slice(n+1).map((function(e){return Object(H.a)({},e,{blockIdx:t})})).concat(o);var i=K(e[t].spans[n].text);Z.log(z.GetNextSpanWithStart,"before iter",{spans:o,startingWordsTo:i});for(var c=0;c<o.length;c++){var l=o[c];if(l.start)return{span:l,wordsTo:i,timeTo:l.start-r,blocksTo:l.blockIdx-t,spansTo:c+1};i+=K(l.text)}var s={id:"song_end",text:"",start:a.audio.length};return{span:s,wordsTo:i,timeTo:s.start-r,blocksTo:e.length-t,spansTo:o.length+1}},this.getTransitionTimes=function(e,t,n){var a=e.spansTo,r=e.blocksTo,o=e.timeTo,i=t,c=n;if(t*a+n*r>o){var l=.5*o;i=l/a,c=r?l/r:0}return Z.log(z.GetTransitionTimes,{spanEnterLen:i,blockLeaveLen:c}),{spanEnterLen:i,blockLeaveLen:c}},this.getSpanTime=function(e,t,n,a){var r=t.timeTo,o=t.wordsTo,i=t.spansTo,c=t.blocksTo,l=Math.max(r-n*i-a*c,0),s=K(e.text),u=s?o/s:0,d=u?Number((1/u*l).toFixed(1)):0;return Z.log(z.GetSpanTime,"calculated",{span:e,nextSpanWithStart:t,spanEnterLen:n,blockLeaveLen:a,wordCount:s,spanBudget:u,timeForSpans:l,spanTime:d}),d},this.blocks=t,this.audio=n,this.events=this.assembleEvents(t)};ee.loadAudioElement=function(){var e=Object(E.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){try{var a=document.createElement("audio"),r=URL.createObjectURL(t);a.src=r;a.addEventListener("loadedmetadata",(function n(){a.removeEventListener("loadedmetadata",n),e({file:t,element:a,length:1e3*a.duration})}))}catch(o){n(o)}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee.fromEditor=function(){var e=Object(E.a)(p.a.mark((function e(t,n,a,r){var o,i,c,l,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.getBlocksAsArray(),Z.log(z.FromEditor,{draftBlocks:o}),i=[],a?i=o.map((function(e){return{id:e.getKey(),spans:G(e.getKey(),e.getText())}})):(c=Object(g.convertToRaw)(t),l=c.entityMap,c.blocks.forEach((function(e){var t=e.entityRanges.map((function(e){return e.key})).map((function(e){return l[e]})).map((function(e){return r.find((function(t){return t.anchorId===e.data.id}))})),n=e.text.split("\u25a0");console.log(t,n);var a=[];n.length>0&&(a.push({id:e.key+"_0",text:n[0]}),t.forEach((function(t,r){a.push({id:"".concat(e.key,"_").concat(r+1),text:n[r+1],start:1e3*t.position})}))),i.push({id:e.key,spans:a})}))),e.next=6,ee.loadAudioElement(n);case 6:return s=e.sent,e.abrupt("return",new ee(i,s));case 8:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}();var te=function(e){var t=u.a.useState(!1),n=Object(f.a)(t,2),a=n[0],r=n[1],o=u.a.useState(!0),i=Object(f.a)(o,2),c=i[0],l=i[1],s=u.a.useState(null),d=Object(f.a)(s,2),m=d[0],v=d[1],g=u.a.useState(),S=Object(f.a)(g,2),y=S[0],T=S[1],k=u.a.useRef(null),A=u.a.useRef(null),N=function(e){var t=u.a.useState([]),n=Object(f.a)(t,2),a=n[0],r=n[1];return{handleAddAnchor:function(t){if(null!==e.current){var n=e.current.addAnchor(t),o={anchorId:t,region:n,position:n.start};r([].concat(Object(b.a)(a),[o]))}},handleRemoveAnchor:function(t){if(null!==e.current){var n=a.findIndex((function(e){return e.anchorId===t}));e.current.removeAnchor(a[n].region);var o=Object(b.a)(a);o.splice(n,1),r(o)}},timestamps:a}}(A),R=N.handleAddAnchor,L=N.handleRemoveAnchor,x=N.timestamps;return u.a.createElement(V,{header:u.a.createElement("nav",{className:"navbar FadeIn",style:y?{animationPlayState:"running"}:{}},u.a.createElement("div",{className:"container"},u.a.createElement("div",{className:"navbar-menu"},!c&&u.a.createElement("div",{className:"navbar-start"},u.a.createElement("div",{className:"navbar-item NavbarText"},"Press Ctrl+. to insert an anchor at your cursor.")),u.a.createElement("div",{className:"navbar-end"},u.a.createElement("div",{className:"navbar-item"},u.a.createElement("div",{className:"field"},u.a.createElement("label",{className:"checkbox NavButton"},u.a.createElement("input",{type:"checkbox",checked:c,onChange:function(){c?l(!1):v("Once you change to manual mode, you can't switch back to automatic.")},style:{marginRight:4}}),"Automatic Mode"))),u.a.createElement("div",{className:"navbar-item"},u.a.createElement("button",{className:"button NavButton",onClick:Object(E.a)(p.a.mark((function t(){var n,a,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=null===(n=k.current)||void 0===n?void 0:n.getContentState(),t.next=3,ee.fromEditor(a,y,c,x);case 3:r=t.sent,e.onWatch(r);case 5:case"end":return t.stop()}}),t)})))},"Watch"))))))},u.a.createElement("div",{className:"TextEditContainer"},u.a.createElement(C,{ref:k,canSetAnchors:void 0!==y&&!c,onAddAnchor:R,onRemoveAnchor:L})),u.a.createElement("div",{className:"AudioEditContainer"},y?u.a.createElement(W,{audio:y,onError:function(){alert("That file could not be processed. Please try again or upload a different file."),T(void 0)},ref:A}):u.a.createElement("button",{className:"BlankButton AddAudioBtn",onClick:function(){return r(!0)}},u.a.createElement(h.a,{icon:"plus-circle",size:"6x"}),u.a.createElement("div",{className:"AddAudioBtnLabel"},"Click to upload audio"))),u.a.createElement(U,{visible:a,onClose:function(){return r(!1)},onSubmit:function(e){r(!1),T(e)}}),u.a.createElement(O,{message:m,onClose:function(){return v(null)}}))},ne=n(201),ae=n(202),re=X(y.TimelineManager),oe=function e(t,n){var a=this;Object(Y.a)(this,e),this.length=void 0,this.track=void 0,this.currentState=void 0,this.setPropertyMap={},this.getEventsSinceLastTick=function(e,t){var n=a.track.filter((function(n){return a.isWithinRegion(n,e,t)})),r=n.map((function(e){var n=a.interpolateState(e,t),r=n.progress,o=n.newState;return{value:t,region:e,state:o,progress:r}}));return re.log(Q.GetEventsSinceLastTick,{last:e,current:t,regions:n,events:r}),r},this.isWithinRegion=function(e,t,n){return e.start>=t&&e.end<=n||(e.start<=n&&e.end>=n||(e.start<=t&&e.end>t||void 0))},this.interpolateState=function(e,t){re.log(Q.InterpolateState,{region:e,current:t,currentState:a.currentState});var n,r,o=Math.min(Math.max(t-e.start,0),e.duration),i=e.duration?o/e.duration:0,c=Object(ne.a)(i),l=!e.duration||1===c,s=Object(H.a)({},a.currentState);if(e.state)for(var u in e.state){var d=a.currentState[u],m=e.state[u],f=m.set,v=m.from,p=m.to;if(void 0===f)if(void 0!==p){var E=void 0!==v?v:d;void 0!==(n=p)&&["string","number","boolean"].includes(typeof n)?s[u]=Object(ae.a)(E,p)(c):s[u]=l?p:E}else re.error(Q.InterpolateState,"from/to is not valid",{region:e,key:u,animProp:m});else a.isPropertyAlreadySet(e.id,u)||(a.markPropertySet(e.id,u),s[u]=(r=f)&&"function"===typeof r?f(d):f)}return re.log(Q.InterpolateState,"after interp",{eased:c,newState:s}),a.currentState=s,{progress:c,newState:s}},this.safePropertyEntry=function(e){return a.setPropertyMap[e]||(a.setPropertyMap[e]=[]),a.setPropertyMap[e]},this.isPropertyAlreadySet=function(e,t){return a.safePropertyEntry(e).includes(t)},this.markPropertySet=function(e,t){a.safePropertyEntry(e).push(t)},this.length=t[t.length-1].end,this.track=t,this.currentState=n,re.log(Q.Construct,{length:this.length,track:t,defaults:n})},ie=X(y.Timeline),ce=function(e){var t=u.a.useRef(),n=u.a.useRef(),a=u.a.useState(0),r=Object(f.a)(a,2),o=r[0],i=r[1],c=u.a.useState(0),l=Object(f.a)(c,2),s=l[0],d=l[1],m=u.a.useState(!1),v=Object(f.a)(m,2),p=v[0],E=v[1],h=e.onTick,g=e.value,b=e.track,S=e.defaultState,y=e.playing,T=e.interval,k=e.onRegion,A=e.onEnded;return u.a.useEffect((function(){if(ie.log(q.Tick,{value:g,queued:o}),t.current&&o){i(0),d(g);var e=g+o;e>=t.current.length&&(e=t.current.length,E(!1),A()),h({value:e})}}),[h,g,o,A]),u.a.useEffect((function(){ie.log(q.NewTimelineManager,{track:b,defaultState:S,hasStarted:p}),p&&(t.current=new oe(b,S))}),[b,S,p]),u.a.useEffect((function(){if(ie.log(q.UpdateInterval,{playing:y,intervalProp:T,intervalRef:n.current}),n.current&&(clearInterval(n.current),n.current=void 0),y){var e=T||10;n.current=setInterval((function(){return i((function(t){return t+e}))}),e),E(!0)}}),[y,T]),u.a.useEffect((function(){(ie.log(q.ValueUpdated,{value:g,lastTick:s}),t.current&&s!==g)&&(d(g),t.current.getEventsSinceLastTick(s,g).forEach(k))}),[k,g,s]),null},le=X(y.AnimatedReader),se=function(e){var t=u.a.useState(),n=Object(f.a)(t,2),a=n[0],r=n[1],o=u.a.useMemo((function(){return{blockOpacity:1,spanOpacity:0,loadedSpans:[],activeSpan:null}}),[]);return u.a.createElement(u.a.Fragment,null,u.a.createElement(ce,{track:e.regions,defaultState:o,value:e.value,playing:e.isPlaying,onTick:e.onTick,onRegion:function(e){le.log(J.HandleRegionEvent,{event:e}),r(u.a.createElement("p",{style:{opacity:e.state.blockOpacity}},e.state.loadedSpans.map((function(e){return e.text})).join(" "),e.state.activeSpan&&u.a.createElement(u.a.Fragment,null," ",u.a.createElement("span",{style:{opacity:e.state.spanOpacity}},e.state.activeSpan.text))))},onEnded:e.onEnded}),u.a.createElement("div",{className:"TextViewport"},a))},ue=function(e){var t=e.readerData,n=u.a.useState(!1),a=Object(f.a)(n,2),r=a[0],o=a[1],i=u.a.useState(0),c=Object(f.a)(i,2),l=c[0],s=c[1],d=u.a.useState(!1),m=Object(f.a)(d,2),v=m[0],h=m[1];if(!t)return u.a.createElement("div",null);var g=function(){var e=Object(E.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=4;break}t.audio.element.pause(),e.next=6;break;case 4:return e.next=6,t.audio.element.play();case 6:o(!r),v&&(s(0),h(!1));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return u.a.createElement(V,null,u.a.createElement(se,{regions:t.events,isPlaying:r,value:l,onTick:function(e){var t=e.value;return s(t)},onEnded:function(){o(!1),h(!0)}}),u.a.createElement(P,{isPlaying:r,onPlayPause:g}))};var de=function(){var e,t=u.a.useState(o.EDIT),n=Object(f.a)(t,2),a=n[0],r=n[1],i=u.a.useState(),c=Object(f.a)(i,2),l=c[0],s=c[1];switch(a){case o.EDIT:e=u.a.createElement(te,{onWatch:function(e){r(o.VIEW),s(e)}});break;case o.VIEW:e=u.a.createElement(ue,{readerData:l});break;default:e=u.a.createElement(V,null)}return e};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var me=n(31),fe=n(26);me.b.add(fe.c,fe.e,fe.d,fe.b,fe.a),m.a.render(u.a.createElement(de,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},95:function(e,t,n){e.exports=n(198)}},[[95,1,2]]]);
//# sourceMappingURL=main.f4bf7070.chunk.js.map